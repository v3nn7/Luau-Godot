-- Godot API Definitions for Luau
-- Place this file in your project root for code completion support
-- Auto-generated by Godot Luau Extension

-- Global Functions
declare function print(...any): nil -- Prints values to console
declare function get_node(path: string): Node? -- Gets a node by path
declare function create_node(class_name: string): Node? -- Creates a new node
declare function load_resource(path: string): Resource? -- Loads a resource
declare function preload(path: string): Resource -- Preloads a resource at compile time

-- Math Functions
declare function sin(angle: number): number -- Sine function
declare function cos(angle: number): number -- Cosine function
declare function tan(angle: number): number -- Tangent function
declare function sqrt(value: number): number -- Square root
declare function abs(value: number): number -- Absolute value
declare function min(a: number, b: number): number -- Minimum of two numbers
declare function max(a: number, b: number): number -- Maximum of two numbers
declare function clamp(value: number, min_val: number, max_val: number): number -- Clamps value between min and max
declare function lerp(from: number, to: number, weight: number): number -- Linear interpolation
declare function move_toward(from: number, to: number, delta: number): number -- Move toward target by delta

-- Conversion Functions
declare function deg_to_rad(degrees: number): number -- Convert degrees to radians
declare function rad_to_deg(radians: number): number -- Convert radians to degrees

-- Type Constructors
declare function Vector2(x: number?, y: number?): Vector2 -- Creates a new Vector2
declare function Vector3(x: number?, y: number?, z: number?): Vector3 -- Creates a new Vector3
declare function Color(r: number?, g: number?, b: number?, a: number?): Color -- Creates a new Color

-- 2D vector class with x and y components
export type Vector2 = {
    x: number, -- X component of the vector
    y: number, -- Y component of the vector
    length: (self: Vector2) -> number, -- Returns the length of the vector
    normalized: (self: Vector2) -> Vector2, -- Returns a normalized version of the vector
    dot: (self: Vector2, other: Vector2) -> number, -- Returns the dot product with another vector
    cross: (self: Vector2, other: Vector2) -> number, -- Returns the cross product with another vector
    distance_to: (self: Vector2, other: Vector2) -> number, -- Distance to another vector
    angle_to: (self: Vector2, other: Vector2) -> number, -- Angle to another vector
    rotated: (self: Vector2, angle: number) -> Vector2, -- Returns rotated vector
    ZERO: Vector2,
    ONE: Vector2,
    UP: Vector2,
    DOWN: Vector2,
    LEFT: Vector2,
    RIGHT: Vector2,
}

declare function Vector2(): Vector2

-- 3D vector class with x, y, and z components
export type Vector3 = {
    x: number, -- X component
    y: number, -- Y component
    z: number, -- Z component
    length: (self: Vector3) -> number, -- Returns the length of the vector
    normalized: (self: Vector3) -> Vector3, -- Returns a normalized version
    dot: (self: Vector3, other: Vector3) -> number, -- Dot product
    cross: (self: Vector3, other: Vector3) -> Vector3, -- Cross product
    distance_to: (self: Vector3, other: Vector3) -> number, -- Distance to another vector
    ZERO: Vector3,
    ONE: Vector3,
    UP: Vector3,
    DOWN: Vector3,
    FORWARD: Vector3,
    BACK: Vector3,
    LEFT: Vector3,
    RIGHT: Vector3,
}

declare function Vector3(): Vector3

-- Color type
export type Color = {
    r: number, -- Red component (0-1)
    g: number, -- Green component (0-1)
    b: number, -- Blue component (0-1)
    a: number, -- Alpha component (0-1)
    to_html: (self: Color, with_alpha: boolean?) -> string, -- Convert to HTML color
    lerp: (self: Color, to: Color, weight: number) -> Color, -- Linear interpolation
}

-- Input singleton for handling input events
export type Input = {
    is_action_pressed: (action: string) -> boolean, -- Returns true if action is currently pressed
    is_action_just_pressed: (action: string) -> boolean, -- Returns true if action was just pressed this frame
    is_action_just_released: (action: string) -> boolean, -- Returns true if action was just released this frame
    get_axis: (negative_action: string, positive_action: string) -> number, -- Returns axis value between -1 and 1
    get_action_strength: (action: string) -> number, -- Returns action strength (0-1)
    set_mouse_mode: (mode: number) -> nil, -- Sets mouse mode
    get_mouse_mode: () -> number, -- Gets current mouse mode
    get_mouse_position: () -> Vector2, -- Gets mouse position
    MOUSE_MODE_VISIBLE: number,
    MOUSE_MODE_HIDDEN: number,
    MOUSE_MODE_CAPTURED: number,
}

declare Input: Input

-- Engine singleton for engine-related functions
export type Engine = {
    get_frames_per_second: () -> number, -- Returns current FPS
    get_physics_frames: () -> number, -- Returns physics frames count
    set_time_scale: (scale: number) -> nil, -- Sets time scale
    get_time_scale: () -> number, -- Gets time scale
}

declare Engine: Engine

-- Base class for all scene objects
export type Node = {
    name: string, -- Name of the node
    process_mode: number, -- Process mode of the node
    get_child: (self: Node, index: number) -> Node, -- Gets child node at index
    get_node: (self: Node, path: string) -> Node?, -- Gets node by path
    get_node_or_null: (self: Node, path: string) -> Node?, -- Gets node by path or null
    add_child: (self: Node, child: Node) -> nil, -- Adds a child node
    remove_child: (self: Node, child: Node) -> nil, -- Removes a child node
    queue_free: (self: Node) -> nil, -- Queues the node for deletion
    get_parent: (self: Node) -> Node?, -- Gets parent node
    get_children: (self: Node) -> {Node}, -- Gets all children
    find_child: (self: Node, name: string, recursive: boolean?) -> Node?, -- Finds child by name
    get_tree: (self: Node) -> SceneTree?, -- Gets the scene tree
    is_in_group: (self: Node, group: string) -> boolean, -- Checks if in group
    add_to_group: (self: Node, group: string) -> nil, -- Adds to group
    remove_from_group: (self: Node, group: string) -> nil, -- Removes from group
    connect: (self: Node, signal: string, target: Node, method: string) -> nil, -- Connects signal
    disconnect: (self: Node, signal: string, target: Node, method: string) -> nil, -- Disconnects signal
    emit_signal: (self: Node, signal: string, ...any) -> nil, -- Emits signal
    _ready: (self: Node) -> nil, -- Called when node is ready
    _process: (self: Node, delta: number) -> nil, -- Called every frame
    _physics_process: (self: Node, delta: number) -> nil, -- Called every physics frame
    _input: (self: Node, event: InputEvent) -> nil, -- Called for input events
    PROCESS_MODE_INHERIT: number,
    PROCESS_MODE_PAUSABLE: number,
    PROCESS_MODE_WHEN_PAUSED: number,
    PROCESS_MODE_DISABLED: number,
}

declare function Node(): Node

-- 2D scene node with position, rotation, and scale
export type Node2D = Node & {
    position: Vector2, -- Position in 2D space
    rotation: number, -- Rotation in radians
    scale: Vector2, -- Scale factor
    global_position: Vector2, -- Global position
    global_rotation: number, -- Global rotation
    global_scale: Vector2, -- Global scale
    z_index: number, -- Z-index for sorting
    translate: (self: Node2D, offset: Vector2) -> nil, -- Translate by offset
    rotate: (self: Node2D, radians: number) -> nil, -- Rotate by radians
    look_at: (self: Node2D, point: Vector2) -> nil, -- Look at point
}

declare function Node2D(): Node2D

-- 2D character physics body
export type CharacterBody2D = Node2D & {
    velocity: Vector2, -- Current velocity
    floor_normal: Vector2, -- Floor normal vector
    motion_mode: number, -- Motion mode
    move_and_slide: (self: CharacterBody2D) -> boolean, -- Moves the body and slides along surfaces
    is_on_floor: (self: CharacterBody2D) -> boolean, -- Returns true if on floor
    is_on_wall: (self: CharacterBody2D) -> boolean, -- Returns true if on wall
    is_on_ceiling: (self: CharacterBody2D) -> boolean, -- Returns true if on ceiling
    get_floor_angle: (self: CharacterBody2D) -> number, -- Gets floor angle
    get_wall_normal: (self: CharacterBody2D) -> Vector2, -- Gets wall normal
    _physics_process: (self: CharacterBody2D, delta: number) -> nil, -- Called every physics frame
}

declare function CharacterBody2D(): CharacterBody2D

-- 2D sprite node
export type Sprite2D = Node2D & {
    texture: Texture2D?, -- Sprite texture
    centered: boolean, -- Whether sprite is centered
    offset: Vector2, -- Texture offset
    flip_h: boolean, -- Horizontal flip
    flip_v: boolean, -- Vertical flip
    modulate: Color, -- Color modulation
}

declare function Sprite2D(): Sprite2D

-- Base class for all resources
export type Resource = {
    resource_path: string --[[readonly]], -- Path to the resource
    get_rid: (self: Resource) -> RID, -- Gets resource ID
}

declare function Resource(): Resource

-- Base class for textures
export type Texture2D = Resource & {
    get_width: (self: Texture2D) -> number, -- Gets texture width
    get_height: (self: Texture2D) -> number, -- Gets texture height
    get_size: (self: Texture2D) -> Vector2, -- Gets texture size
}

-- Input event base class
export type InputEvent = Resource & {
    device: number, -- Input device ID
    is_action: (self: InputEvent, action: string) -> boolean, -- Checks if event is action
    is_action_pressed: (self: InputEvent, action: string) -> boolean, -- Checks if action pressed
    is_pressed: (self: InputEvent) -> boolean, -- Checks if event is pressed
}

-- Scene tree singleton
export type SceneTree = {
    current_scene: Node?, -- Current scene root
    change_scene_to_file: (self: SceneTree, path: string) -> Error, -- Changes scene to file
    change_scene_to_packed: (self: SceneTree, scene: PackedScene) -> Error, -- Changes scene to packed
    reload_current_scene: (self: SceneTree) -> Error, -- Reloads current scene
    quit: (self: SceneTree, exit_code: number?) -> nil, -- Quits application
    paused: boolean, -- Pause state
    create_timer: (self: SceneTree, time: number) -> Timer, -- Creates a timer
}

-- Timer node
export type Timer = Node & {
    wait_time: number, -- Wait time in seconds
    one_shot: boolean, -- Whether timer fires once
    autostart: boolean, -- Whether timer starts automatically
    time_left: number --[[readonly]], -- Time left
    start: (self: Timer, time: number?) -> nil, -- Starts timer
    stop: (self: Timer) -> nil, -- Stops timer
    is_stopped: (self: Timer) -> boolean, -- Checks if stopped
}

declare function Timer(): Timer

-- Global constants
declare Godot: {
    PI: number,
    TAU: number,
    E: number,
    SQRT2: number,
    OK: number,
    ERR_FILE_NOT_FOUND: number,
    ERR_FILE_CANT_OPEN: number,
    FILE_READ: number,
    FILE_WRITE: number,
    FILE_READ_WRITE: number,
}
